<% provide :head_tags do %>
    <script>
    var marker_icon = '<%= image_url('parachute.png') %>';
    document.addEventListener("DOMContentLoaded", function(){
        initMap(<%= @lat %>, <%= @lng %>, JSON.parse('<%= raw(escape_javascript(@fly_sites_gmaps_json)) %>'), true)
    });
    </script>
<% end %>
<div class="row" id='searchBarRow'>
  <div class="input-group mb-3">
    <input type="text" class="form-control" id="search-bar" 
      onclick="askOnceForLocation()" placeholder="Oakland, CA" 
      aria-label="Search for flying sites" aria-describedby="button-addon2">
    <div class="input-group-append">
      <button class="btn btn-outline-secondary" type="button" 
        id="button-addon2"><i class="fas fa-search-location"></i>
      </button>
    </div>
  </div>
</div>
<div class="row border p-2">
  <div class="col-12" id="map"></div>
</div>
<div class="row border">
  <div class="col-12" id="site-list">
    <% @fly_sites.each do |fly_site| %>
      <div class="row border-bottom">
        <div class="favorite col-2 pl-1 pr-2 pb-1 pt-1">
          <% if user_signed_in? %>
            <%= link_to favorite_fly_site_path(fly_site), method: 'post', remote: true do %>
              <span id='fly_site_<%= fly_site.id %>_favorite'>
                <% if current_user.favorited?(fly_site) %>
                  <i class="fas fa-heart text-warning"></i> 
                <% else %>
                  <i class="far fa-heart text-secondary"></i>
                <% end %>
              </span>
            <% end %>
          <% end %>
          <%= link_to fly_site.name, fly_site %>
        </div>
        <div class="col-9 pl-2 pr-2 pb-1 pt-1">
          <%= render partial: "shared/dow_row", locals: { fly_site: fly_site } %>
        </div>
      </div>
    <% end %>
  </div>
</div>
<div class="row border p-2">
  <div class="custom_pagination">
    <%= will_paginate @fly_sites, :container => false %>
  </div>
</div>