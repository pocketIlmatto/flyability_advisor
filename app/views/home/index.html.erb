<% provide :head_tags do %>
    <script>
    var marker_icon = '<%= image_url('parachute.png') %>';
    document.addEventListener("DOMContentLoaded", function(){
        initMap(<%= @lat %>, <%= @lng %>, JSON.parse('<%= raw(escape_javascript(@fly_sites_gmaps_json)) %>'), true)
    });
    </script>
<% end %>

<div class="modal" tabindex="-1" role="dialog" id="newStuffModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Coming soon</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <ul>
          <li>Filter list with a search bar</li>
          <li>Set personal SMS and email alerts for upcoming flyable days</li>
          <li>Filter list by pilot rating</li>
          <li>Suggest new flying sites</li>
          <li>Updates to flyability calculation - precipitation, cloudbase, etc.</li>
          <li>More contextual data, model comparisons, links to XCSkies, etc.</li>
        </ul>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Got it!</button>
      </div>
    </div>
  </div>
</div>
  
<div class="container mt-2">
  <div class="row" id='searchBarRow'>
    <div class="input-group mb-3">
      <input type="text" class="form-control" id="search-bar" 
        onclick="askOnceForLocation()" placeholder="Oakland, CA" 
        aria-label="Search for flying sites" aria-describedby="button-addon2">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary" type="button" 
          id="button-addon2"><i class="fas fa-search-location"></i>
        </button>
      </div>
    </div>
  </div>
  <div class="row border p-2">
    <div class="col-12" id="map"></div>
  </div>
  <div class="row border">
    <div class="col-12" id="site-list">
      <% @fly_sites.each do |fly_site| %>
        <div class="row border-bottom">
          <div class="col-3 pl-2 pr-2 pb-1 pt-1">
            <%= link_to fly_site.name, fly_site %>
          </div>
          <div class="col-9 pl-2 pr-2 pb-1 pt-1">
            <%= render partial: "shared/dow_row", locals: { fly_site: fly_site } %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>